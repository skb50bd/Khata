@using Khata.ViewModels
@using static Khata.Domain.SaleType
@model SaleViewModel


@{
    var sym = System.Globalization.CultureInfo.CurrentCulture.NumberFormat.CurrencySymbol;
}

<div asp-validation-summary="ModelOnly" class="text-danger"></div>

<div>
    @*Sale Info*@
    <input type="hidden" asp-for="Id" />
    <div class="form-group">
        <label asp-for="SaleDate" class="control-label"></label>
        <input asp-for="SaleDate" type="text" class="form-control datepicker" autocomplete="off" />
        <span asp-validation-for="SaleDate" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="Type" class="control-label"></label>
        <br />
        <div class="form-check form-check-inline">
            <input asp-for="Type" class="form-check-input" type="radio" id="retail" value="1" checked>
            <label class="form-check-label" for="retail">
                Retail
            </label>
        </div>
        <div class="form-check form-check-inline">
            <input asp-for="Type" class="form-check-input" type="radio" id="bulk" value="2">
            <label class="form-check-label" for="bulk">
                Whole Sale
            </label>
        </div>
        <span asp-validation-for="Type" class="text-danger"></span>
    </div>

    <hr />

    @*Customer*@
    <div class="form-group" hidden>
        <label asp-for="CustomerId" class="control-label"></label>
        <input asp-for="CustomerId" class="form-control" />
        <span asp-validation-for="CustomerId" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label class="control-label h5" asp-for="Customer"></label>
        <input id="customer-selector"
               class="form-control"
               type="text"
               data-path="@Url.Action("GetIds", "Customers")" />
    </div>

    <div class="form-group">
        <div class="form-check">
            <input asp-for="RegisterNewCustomer"
                   class="form-check-input"
                   type="checkbox"
                   data-toggle="collapse"
                   href="#customerInputCollapse">
            <label asp-for="RegisterNewCustomer" class="form-check-label"></label>
        </div>
    </div>

    <div class="collapse" id="customerInputCollapse">
        <div class="form-group">
            <label asp-for="Customer.FirstName" class="control-label"></label>
            <input asp-for="Customer.FirstName" type="text" class="form-control customer-input" />
            <span asp-validation-for="Customer.FirstName" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="Customer.LastName" class="control-label"></label>
            <input asp-for="Customer.LastName" type="text" class="form-control customer-input" />
            <span asp-validation-for="Customer.LastName" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="Customer.CompanyName" class="control-label"></label>
            <input asp-for="Customer.CompanyName" type="text" class="form-control customer-input" />
            <span asp-validation-for="Customer.CompanyName" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="Customer.Address" class="control-label"></label>
            <textarea asp-for="Customer.Address" class="form-control customer-input"></textarea>
            <span asp-validation-for="Customer.Address" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="Customer.Phone" class="control-label"></label>
            <input asp-for="Customer.Phone" type="text" class="form-control customer-input" />
            <span asp-validation-for="Customer.Phone" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="Customer.Email" class="control-label"></label>
            <input asp-for="Customer.Email" type="text" class="form-control customer-input" />
            <span asp-validation-for="Customer.Email" class="text-danger"></span>
        </div>
    </div>

    <hr />

    @*Cart*@
    <label class="h5">Cart</label>

    <div class="form-group" hidden>
        <label class="control-label"></label>
        <input class="form-control" id="lineitem-id" type="number" />
    </div>

    <div class="form-group" hidden>
        <label class="control-label"></label>
        <input class="form-control" type="number" id="lineitem-type" />
    </div>

    <div class="form-group">
        <label class="control-label" for="lineitem-selector">Item</label>
        <input id="lineitem-selector"
               class="form-control"
               type="text"
               data-path="@Url.Action("GetLineItems", "Sales")" />
    </div>

    <div class="form-group">
        <label class="control-label" for="lineitem-quantity">Qty.</label>
        <input id="lineitem-quantity"
               class="form-control"
               type="number" min="0" />
    </div>

    <div class="form-group">
        <label class="control-label" for="lineitem-unitprice">Unit Price</label>
        <div class="input-group">
            <div class="input-group-prepend">
                <span class="input-group-text">@sym</span>
            </div>
            <input id="lineitem-unitprice"
                   class="form-control"
                   type="number" min="0" />
        </div>
        <span validation-for="lineitem-unitprice" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label class="control-label" for="lineitem-netprice">Net Price</label>
        <div class="input-group">
            <div class="input-group-prepend">
                <span class="input-group-text">@sym</span>
            </div>
            <input id="lineitem-netprice"
                   class="form-control"
                   type="number" min="0" />
        </div>
    </div>

    <div class="form-group">
        <button class="btn btn-outline-primary" id="lineitem-add-button">Add Item</button>
        <button class="btn btn-outline-secondary" id="lineitem-clear-button">Clear Item</button>
    </div>

    <table>
        <thead>
            <tr>
                <th hidden>Id</th>
                <th hidden>Type</th>
                <th>Name</th>
                <th>Qty.</th>
                <th>Unit Price</th>
                <th>Net Price</th>
                <th></th>
            </tr>
        </thead>
        <tbody id="cart"></tbody>
    </table>

    <hr />

    @*Payment*@

    <label class="h5">Payment Information</label>

    <div class="form-group">
        <label for="subtotal" class="control-label">Subtotal</label>
        <div class="input-group">
            <div class="input-group-prepend">
                <span class="input-group-text">@sym</span>
            </div>
            <input id="subtotal" type="number" class="form-control" disabled />
        </div>
    </div>

    <div class="form-group">
        <label asp-for="Payment.DiscountCash" class="control-label"></label>
        <div class="input-group">
            <div class="input-group-prepend">
                <span class="input-group-text">@sym</span>
            </div>
            <input asp-for="Payment.DiscountCash" type="number" class="form-control" />
        </div>
        <span asp-validation-for="Payment.DiscountCash" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Payment.DiscountPercentage" class="control-label"></label>
        <div class="input-group">
            <input asp-for="Payment.DiscountPercentage"
                   type="number"
                   class="form-control"
                   min="0"
                   max="80" />
            <div class="input-group-append">
                <span class="input-group-text">%</span>
            </div>
        </div>
        <span asp-validation-for="Payment.DiscountPercentage" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label for="debt-before" class="control-label">Previous Due</label>
        <div class="input-group">
            <div class="input-group-prepend">
                <span class="input-group-text">@sym</span>
            </div>
            <input id="debt-before" type="number" class="form-control" disabled />
        </div>
    </div>

    <div class="form-group">
        <label for="payable" class="control-label">Payable</label>
        <div class="input-group">
            <div class="input-group-prepend">
                <span class="input-group-text">@sym</span>
            </div>
            <input id="payable" type="number" class="form-control" disabled />
        </div>
    </div>

    <div class="form-group">
        <label asp-for="Payment.Paid" class="control-label"></label>
        <div class="input-group">
            <div class="input-group-prepend">
                <span class="input-group-text">@sym</span>
            </div>
            <input asp-for="Payment.Paid" type="number" class="form-control" />
        </div>
        <span asp-validation-for="Payment.Paid" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label for="debt-after" class="control-label">New Due</label>
        <div class="input-group">
            <div class="input-group-prepend">
                <span class="input-group-text">@sym</span>
            </div>
            <input id="debt-after" type="number" class="form-control" disabled />
        </div>
    </div>

    <hr />

    <div class="form-group">
        <label asp-for="Description" class="control-label"></label>
        <textarea asp-for="Description" type="text" class="form-control"></textarea>
        <span asp-validation-for="Description" class="text-danger"></span>
    </div>
</div>